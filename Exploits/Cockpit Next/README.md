# Cockpit Next CMS

## Installation

To install the vulnerable software, the download can be found at [this link](https://github.com/aheinze/fetch_url_contents%EF%BC%89project).

There is no installer for this application, the zip file should be extracted on the server's folder. We tested the exploit both in Windows 10 with XAMPP server + MySql (*\xampp\htdocs*) and in Kali Linux with Apache2 (*/var/www/html/*). 
Then the installation process should be done following the vendor's documentation at [this link](https://github.com/agentejo/cockpit).

### Issues

To run the *cockpit/installer* on the Kali Linux environment there are some more passages to do than Windows, since on that platform XAMPP has all the requirements pre-built in. 
In Kali Linux Apache2 and MySql should be up and running with the commands: 

```bash
service apache2 start
service mysql start
```

Then also SQLite should be installed by running: 

```bash
sudo apt install php-sqlite
```

Finally the *mod_rewrite* in Apache2 should be set up, the following [guide](https://www.digitalocean.com/community/tutorials/how-to-set-up-mod_rewrite) could be helpful since it is not an immediate process.

## Exploit

On the Windows environment we tested this exploit accessing the server from an another machine running Kali, and sending the POST requests with BurpSuite from there. The Directory Traversal was very successful and we could access other parts of the system from the server's folder, creating/editing/deleting files that were not protected by strict permissions.

On the Linux environment we automatized the process with the *autoscript.sh*, however due to the different permission structure of UNIX systems, we were able just to list the current directory's content, as shown in the attached images. 